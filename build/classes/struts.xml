<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE struts PUBLIC
	"-//Apache Software Foundation//DTD Struts Configuration 2.3//EN"
	"http://struts.apache.org/dtds/struts-2.3.dtd">

<struts>

	<constant name="struts.enable.DynamicMethodInvocation" value="true" />
	<!-- 主题 -->
	<constant name="struts.ui.theme" value="simple"></constant>
	<!-- 开发模式 -->
	<constant name="struts.devMode" value="true"></constant>
	<!-- 允许静态方法调用 -->
	<constant name="struts.ognl.allowStaticMethodAccess" value="true"></constant>
	<package name="default" namespace="/" extends="struts-default">

		<interceptors>
			<!-- 注册登录拦截器 -->
			<interceptor name="loginInterceptor" class="com.yech.yechblog.interceptor.LoginInterceptor">
				 <param name="excludeMethods">pagination,readDetail,logout</param>  
			</interceptor>
			<!-- 定义拦截器栈 -->
			<interceptor-stack name="yechblogStack">
				<interceptor-ref name="loginInterceptor"></interceptor-ref>
				<interceptor-ref name="defaultStack">
					<!-- 上传文件的大小 kb-->
					<param name="fileUpload.maximumSize">600000</param>
					<!-- 上传文件的扩展名 -->
					<param name="fileUpload.allowedExtensions">.jpg,.jpeg,.png,.bmp,.gif</param>
					<!-- 文件的内容类型 -->
					<param name="fileUpload.allowedTypes">image/jpg,image/jpeg,image/png,image/bmp,image/gif</param>
				</interceptor-ref>
			</interceptor-stack>
		</interceptors>	
		<!-- 定义默认拦截器栈 -->
		<default-interceptor-ref name="yechblogStack"></default-interceptor-ref>
		
		<!-- 定义全局结果,返回到登录界面 -->
		<global-results>
			<!-- 进行写操作时先登录 -->
			<result name="login">/views/login.jsp</result>
			<result name="error_no_right">/views/blogIndex.jsp</result>
			<result name="allBlogList">/views/blogIndex.jsp</result>
			<!-- 登录成功后重定向到 BlogAction，用于进入首页 -->
			<result name="BlogAction" type="redirectAction">
				<param name="namespace">/</param>
				<param name="actionName">BlogAction_pagination</param>
			</result>
		</global-results>

		<!-- RegistAction -->
		<action name="RegistAction_*" class="registAction" method="{1}">
			<result name="registPage">/views/regist.jsp</result>
			<result name="success">/views/blogIndex.jsp</result>
			<result name="input">/views/regist.jsp</result>
		</action>
		
		<!-- IdentifyCodeAction -->
		<action name="IdentifyCodeAction_*" class="identifyCodeAction" method="{1}">
			<result name="success" type="stream">
				<param name="contentType">image/jpeg</param>
   				<param name="inputName">inputStream</param>
			</result>
		</action>
		
		<!-- loginAction -->
		<action name="LoginAction_*" class="loginAction" method="{1}">
			<result name="loginPage">/views/login.jsp</result>
			<result name="input">/views/login.jsp</result>
		</action>
		
		<!-- blogAction -->
		<action name="BlogAction_*" class="blogAction" method="{1}">
			<result name="myBlogList">/views/myBlogList.jsp</result>
			<result name="toWriteBlogPage">/views/writeBlog.jsp</result>
			<result name="detailReadPage">/views/detailRead.jsp</result>
			<result name="personalPage">/views/personalPage.jsp</result>
			<!-- 登录成功后重定向到 BlogAction，用于进入首页 -->
			<result name="BlogAction" type="redirectAction">
				<param name="namespace">/</param>
				<param name="actionName">BlogAction_pagination</param>
			</result>
		</action>
		
		<!-- commentAction -->
		<action name="CommentAction_*" class="commentAction" method="{1}">
			<result name="toDetailReadPage" type="redirectAction">
				<param name="namespace">/</param>
				<param name="actionName">BlogAction_readDetail</param>
				<param name="bid">${bid}</param>
			</result>
		</action>
		
		<!-- UserAction -->
		<action name="UserAction_*" class="userAction" method="{1}">
			<result name="personalPage">/views/personalPage.jsp</result>
			<result name="input">/views/personalPage.jsp</result>
			<result name="toMessageCenterPage">/views/messageCenterPage.jsp</result>
		</action>
		
		<!-- MessageAction -->
		<action name="MessageAction_*" class="messageAction" method="{1}">
			<result name="toDetailMessagePage">/views/detailMessagePage.jsp</result>
		</action>
	</package>

</struts>
